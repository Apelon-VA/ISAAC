<?xml version="1.0" encoding="UTF-8"?>
<?schematron-schema href="../main/schematron/knowledgeartifact.sch"?>
<?schematron-schema href="../main/schematron/ecarules.sch"?>
<knowledgeDocument xmlns="urn:hl7-org:knowledgeartifact:r1"
	xmlns:vmr="urn:hl7-org:vmr:r2"
	xmlns:dt="urn:hl7-org:cdsdt:r2" xmlns:p1="http://www.w3.org/1999/xhtml"
	xmlns:xml="http://www.w3.org/XML/1998/namespace" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:hl7-org:knowledgeartifact:r1 ../schema/knowledgeartifact/knowledgedocument.xsd ">	
	<metadata>
		<identifiers>
			<identifier root="BetaBlockerforMIpatient" version="1.0" />
		</identifiers>
		<artifactType value="Rule" />
		<schemaIdentifier root="urn:hl7-org:knowledgeartifact:r1" version="1.0" />	
		<dataModels>
			<modelReference>
				<description value="Virtual Medical Record model" />
				<referencedModel value="urn:hl7-org:vmr:r2"/>
			</modelReference>
		</dataModels>
		<title value="Order a beta-blocker for heart attack patient."/>
		<description value="Order a beta-blocker for heart attack patient at discharge, if not already ordered."/>
		<keyTerms>
			<term><dt:originalText value="Beta-Blocker"/></term>
			<term><dt:originalText value="Heart Attack"/></term>
			<term><dt:originalText value="Myocardial Infarction"/></term>		
			<term><dt:originalText value="Discharge"/></term>
			<term><dt:originalText value="SNOMED"/></term>
			<term><dt:originalText value="IHTSDO"/></term>
		</keyTerms>
		<status value="Draft" />
		<eventHistory>
			<artifactLifeCycleEvent>
				<eventType value="Created" />
				<eventDateTime value="20120505" />
			</artifactLifeCycleEvent>
			<artifactLifeCycleEvent>
				<eventType value="Pre-published" />
				<eventDateTime value="20140625" />
			</artifactLifeCycleEvent>
		</eventHistory>		
		<contributions>
			<contribution>
				<contributor xsi:type="Organization">
					<addresses>
						<address>
							<dt:part type="SAL" value="750 Main Street Ste 802" />
							<dt:part type="CTY" value="Hartford" />
							<dt:part type="ZIP" value="06103" />
							<dt:part type="STA" value="CT" />
							<dt:part type="CNT" value="USA" />
						</address>
					</addresses>
					<contacts>
					<contact value="203-431-2530" use="WP" capabilities="voice" />
					<contact value="203-431-2523" use="WP" capabilities="fax" />
					</contacts>
				<name value="Apelon" />
				</contributor>
				<role value="Author"/>
			</contribution>
			<contribution>
				<contributor xsi:type="Organization">
					<addresses>
						<address>
						<dt:part type="CTY" value="Washington, DC" />
						<dt:part type="ZIP" value="20420" />
						<dt:part type="CNT" value="USA" />
						</address>
					</addresses>
					<contacts>
					<contact value="877-234-5678" use="WP" />
					</contacts>
				<name value="VHA" />
				</contributor>
				<role value="Reviewer"/>
			</contribution>
		</contributions>
		<publishers>
			<publisher xsi:type="Organization">
				<addresses>
					<address>
						<dt:part type="CTY" value="Washington, DC" />
						<dt:part type="ZIP" value="20420" />
						<dt:part type="CNT" value="USA" />
					</address>
				</addresses>
				<contacts>
					<contact value="877-234-5678" use="WP" />
				</contacts>
				<name value="VHA" />
			</publisher>
		</publishers>
		<usageTerms>
			<rightsDeclaration>
				<assertedRights value="Copyright (2014), US Department of Veterans Affairs" />
				<rightsHolder xsi:type="Organization">
					<addresses>
						<address>
							<dt:part type="CTY" value="Washington, DC" />
							<dt:part type="ZIP" value="20420" />
							<dt:part type="CNT" value="USA" />
						</address>
					</addresses>
					<contacts>
						<contact value="877-234-5678" use="WP" />
					</contacts>
					<name value="VHA" />
				</rightsHolder>
			</rightsDeclaration>
		</usageTerms>
	</metadata>
	<externalData>
		<def name="Patient">
			<expression xsi:type="ClinicalRequest" cardinality="Single"
				dataType="vmr:EvaluatedPerson" isInitial="true">
				<description>Patient object of patient who has been evaluated.</description>
			</expression>
		</def>
		<def name="AcuteMIDiagnosisSNOMED">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple" useValueSets="true"
				dataType="vmr:Problem" codeProperty="conditionCode" dateProperty="diagnosticEventTime.low">
				<description>One or more diagnosis codes for acute myocardial infarction have been entered. </description>
				<codes xsi:type="ValueSet" id="2.16.840.1.113883.3.464.1003.104.12.1001" authority="NIH VSAC"
						version="1.0" />
			</expression>
		</def>
		<def name="MITreatedDischarged">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple" useValueSets="true"
				dataType="vmr:EncounterEvent" codeProperty="encounterType" dateProperty="diagnosticEventTime.high">
				<description>Discharge after patient treated for acute myocardial infarction. </description>
				<codes xsi:type="ValueSet" id="2.16.840.1.113883.3.464.1003.104.12.1001" authority="NIH VSAC"
						version="1.0" />
			</expression>
		</def>
		<def name="BetaBlockerOrder">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple"
				dataType="vmr:SubstanceAdministrationEvent" codeProperty="substanceAdministrationGeneralPurpose"
				dateProperty="administrationTimeInterval.low" useValueSets="true">
				<description>Patient has been prescribed a beta-blocker</description>
				<codes xsi:type="ValueSet" id="2.16.840.1.113883.3.526.3.1174" authority="NIH VSAC"
					version="1.0" />
			</expression>
		</def>
		<def name="SickSinusSyndromeSNOMED">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple"
				dataType="vmr:Problem" codeProperty="conditionCode" dateProperty="diagnosticEventTime.low">
				<description>Sick sinus syndrome diagnosis code has been entered.</description>
				<codes xsi:type="List">
					<element xsi:type="CodeLiteral" code="36083008"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="Sick sinus syndrome (disorder)" />
					<element xsi:type="CodeLiteral" code="233913007"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="Familial sick sinus syndrome (disorder)" />
					<element xsi:type="CodeLiteral" code="117881000119103"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="History of sick sinus syndrome (disorder)" />
				</codes>
			</expression>
		</def>
		<def name="SlowPulseSNOMED">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple"
				dataType="vmr:ObservationResult" codeProperty="observationFocus" dateProperty="observationEventTime.low">
				<description> Patient has very slow pulse on examination.</description>
				<codes xsi:type="List">
					<element xsi:type="CodeLiteral" code="162987003"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="On examination - pulse rate very slow (finding)" />
				</codes>
			</expression>
		</def>
		<def name="2ndDegreeAVBlockSNOMED">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple"
				dataType="vmr:Problem" codeProperty="conditionCode" dateProperty="diagnosticEventTime.low">
				<description> Second degree AV block diagnosis code has been entered.</description>
				<codes xsi:type="List">
					<element xsi:type="CodeLiteral" code="284941000119107"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="High degree second degree atrioventricular block (disorder)" />
					<element xsi:type="CodeLiteral" code="28189009"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="Mobitz type II atrioventricular block (disorder)" />
					<element xsi:type="CodeLiteral" code="195042002"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="Second degree atrioventricular block (disorder)" />
				</codes>
			</expression>
		</def>
		<def name="3rdDegreeAVBlockSNOMED">
			<expression xsi:type="ClinicalRequest" cardinality="Multiple"
				dataType="vmr:Problem" codeProperty="conditionCode" dateProperty="diagnosticEventTime.low">
				<description> Third degree AV block diagnosis code has been entered.</description>
				<codes xsi:type="List">
					<element xsi:type="CodeLiteral" code="27885002"
						codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED-CT"
						displayName="Complete atrioventricular block (disorder)" />
				</codes>
			</expression>
		</def>
	</externalData>
	<conditions>
		<condition>
			<logic xsi:type="And">
				<description> Patient is being discharged after a heart attack, does not have a beta blocker already ordered,
				and does not have any contraindications for a beta-blocker."
				</description>
				<operand xsi:type="IsNotEmpty">
					<description>Patient has been diagnosed with an acute myocardial infarction.</description>
					<operand xsi:type="ExpressionRef" name="AcuteMIDiagnosisSNOMED" />
				</operand>
				<operand xsi:type="IsNotEmpty">
					<description>Patient has been discharged after handling a case of acute myocardial infarction.</description>
					<operand xsi:type="ExpressionRef" name="MITreatedDischarged" />
				</operand>
				<operand xsi:type="IsEmpty">
					<description>Order for a beta-blocker.</description>
					<operand xsi:type="ExpressionRef" name="BetaBlockerOrder" />
				</operand>
				<operand xsi:type="IsEmpty">
					<description>Exclusion-Sick sinus syndrome.</description>
					<operand xsi:type="ExpressionRef" name="SickSinusSyndromeSNOMED" />
				</operand>
				<operand xsi:type="IsEmpty">
					<description>Exclusion- very slow pulse rate.</description>
					<operand xsi:type="ExpressionRef" name="SlowPulseSNOMED" />
				</operand>
				<operand xsi:type="IsEmpty">
					<description>Exclusion- second degree AV block.</description>
					<operand xsi:type="ExpressionRef" name="2ndDegreeAVBlockSNOMED" />
				</operand>
				<operand xsi:type="IsEmpty">
					<description>Exclusion- third degree AV block.</description>
					<operand xsi:type="ExpressionRef" name="3rdDegreeAVBlockSNOMED" />
				</operand>
			</logic>	
			<conditionRole value="ApplicableScenario"/>	
		</condition>
	</conditions>
	<actionGroup>
		<behaviors>
			<behavior xsi:type="GroupSelectionBehavior" value="All"/>
		</behaviors>
		<title value="Beta-blocker Order for Heart Attack Patient" />
		<description value="Alert the physician that no beta-blocker has been ordered for this patient, 
		being discharged for heart attack encounter. Prescribe beta-blocker." />
		<subElements>
			<simpleAction xsi:type="CreateAction">
				<actionSentence xsi:type="ObjectExpression"
					objectType="vmr:CommunicationProposal">
					<property name="message">
						<value xsi:type="ComplexLiteral">
							<value xsi:type="dt:ED"
								value="No beta-blockers have been ordered for patient being discharged after a heart attack.  Beta-blockers is now being ordered." />
						</value>
					</property>
				</actionSentence>
			</simpleAction>
			<actionGroup>
				<behaviors>
					<behavior xsi:type="GroupSelectionBehavior" value="All"/>
				</behaviors>
				<title value="Submit an order for a beta-blocker" />
				<subElements>
					<simpleAction xsi:type="CreateAction">
						<textEquivalent value="Prescribe a beta-blocker" />
						<actionSentence xsi:type="ObjectExpression"
							objectType="vmr:SubstanceAdministrationProposal">
							<description>Prescribe a beta blocker</description>
							<property name="substance.substanceCode">
								<value xsi:type="ValueSet" id="2.16.840.1.113883.3.526.3.1174" authority="NIH VSAC"
								version="1.0"/>
							</property>
						</actionSentence>
					</simpleAction>
					<simpleAction xsi:type="CreateAction">
						<textEquivalent value="Update patient's active medication list to include prescription of beta-blocker medication." />
						<actionSentence xsi:type="ObjectExpression"
							objectType="vmr:SubstanceAdministrationEvent">
							<description>Update patient's active medication list</description>
							<property name="substance.substanceCode">
								<value xsi:type="ValueSet" id="2.16.840.1.113883.3.526.3.1174" authority="NIH VSAC"
								version="1.0" />
							</property>
						</actionSentence>
					</simpleAction>
				</subElements>
			</actionGroup>
		</subElements>
	</actionGroup>
</knowledgeDocument>